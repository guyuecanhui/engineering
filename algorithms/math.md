# 数学小Puzzle

---

<!--sec data-title="随机数构造" data-id="math_0" data-show=true ces-->
> 已知有个rand7()的函数，返回1到7随机自然数，让利用这个rand7()构造rand10() 随机1~10。

### Analyze
关键是要使rand10()生成的每个数概率为1/10。联想到连续运行两次rand7()的结果排列有49种，并且每个结果排列出现的概率为1/49，可以考虑从这些排列入手。转化的关键在于将两次生成的数的排列变成一个概率为1/49的数字，这样后面可以通过过滤的方式得到概率为1/10的数。

### Answer
```c
int rand10() {  
  int a71,a72,a10;  
  do {  
    a71= rand7()-1;  
    a72 = rand7()-1;  
    a10 = a71 *7 + a72;  
  } while (a10>= 40);  
  return (a71*7+a72)/4+1; 
} 
```
<!--endsec-->

<!--sec data-title="随机选取关键字" data-id="math_1" data-show=true ces-->

> 给定一个数据流，其中包含无穷尽的搜索关键字（比如，人们在谷歌搜索时不断输入的关键字）。如何才能从这个无穷尽的流中随机的选取1000个关键字？

### Analyze
**1、首先考虑从无穷多数中随机选择一个数的情况：**

* 第一个数必选，概率为1；
* 第 $$i$$ 个数以 $$\frac{1}{i}$$ 的概率替换当前选中的数；

按照这种方法，假设一共有 $$n$$ 个数，则第 $$i$$ 个数最终被选中的概率为它在第 $$i$$ 轮被选中，且之后的数都未被选中的概率，即：
$$
\frac{1}{i}\cdot \frac{i}{i+1} \cdots \frac{n-1}{n}= \frac{1}{n}.
$$

**2、再考虑从无穷多数中随机选择k个数的情况：**

* 前 $$k$$ 个数必选，概率为1；
* 第 $$i$$ 个数以 $$\frac{1000}{i}$$ 的概率随机替换当前 $$k$$ 个数中的一个；

假设有 $$n$$ 个数，则前 $$k$$ 个数最终被选中的概率为后面数都不将它替换的概率，即：
$$
1\cdot (\frac{k}{k+1}\cdot \frac{k-1}{k}+\frac{1}{k+1})\cdots(\frac{k}{n}\cdot\frac{k-1}{k}+\frac{n-k}{n})=1\cdot \frac{k}{k+1} \cdots \frac{n-1}{n}= \frac{k}{n}.
$$
类似的，第i (i>k) 个数最终被选中的概率为它被选中，且后面数都不将它替换的概率，即：
$$
\frac{k}{i}\cdot \frac{i}{i+1} \cdots \frac{n-1}{n}= \frac{k}{n}.
$$


### Answer
```c
void Select(string key[1000]) {
  string cur;
  int cnt = 0;
  while (cin >> cur) {
    if (cnt < 1000) {
      key[cnt++] = cur;
    }
    else if (rand()%cnt < 1000) {
        key[rand()%1000] = cur;
    }
  }
}
```

<!--endsec-->

<!--sec data-title="小白鼠试毒药" data-id="math_2" data-show=true ces-->

> 我们有很多瓶无色的液体，其中有一瓶是毒药，其它都是蒸馏水，实验的小白鼠喝了以后会在5分钟后死亡，而喝到蒸馏水的小白鼠则一切正常。现在有5只小白鼠，请问一下，我们用这五只小白鼠，5分钟的时间，能够检测多少瓶液体的成分？

### Answer
假设有n只小白鼠，则：

* 让n只中的任意一只服用一种液体；
* 让n只中的任意两只服用同一种液体；
* 让n只中的任意三只服用同一种液体；
* ……
* 让所有n只服用同一种液体；

因此总共可以检测出N种液体成分：
$$
N = C_n^1+C_n^2+\cdots+C_n^n = A_n-C_n^0 = 2^n-1.
$$
例如n=3时：

| 白鼠1 | 白鼠2 | 白鼠3 |
|:-----:|:-----:|:-----:|
| 1     | 2     | 3     |
| 4     | 4     |       |
| 5     |       | 5     |
|       | 6     | 6     |
| 7     | 7     | 7     |

因此，当n=5时，可以检测31种液体成分。

<!--endsec-->