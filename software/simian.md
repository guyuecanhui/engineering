# Netflix — Simian Army

---

### Netflix和Simian Army背景

在任何一个时刻，Netflix都会利用在亚马逊数据中心运行的一万到两万台服务器，这些服务器负责处理客户信息、视频推荐、数字版权管理、将视频文件编码为不同格式以及监控系统性能等事务。

自依靠亚马逊来获得数据中心服务以来，Netflix的700名工程师一直都将重点放在开发工具的问题上，比如说能让数以千计的云服务器自动化启动和配置的方法等。

在硅谷中，Netflix最出名的地方已经变成了其所谓的“类人猿大军”(Simian Army)，也就是用来测试系统恢复力的各种应用的谑称。

### 什么是Simian Army

Simian Army就是一系列通过产生各种失效和故障来测试云服务的鲁棒性的工具集，这些工具集被戏称为Monkey。

每种Monkey都是一个自动化的软件代理，它们设计的目标是让Netflix的服务更加健壮且持续提供高质量服务，即使存在少部分的失效故障，也能通过优雅降级的方式保证服务可用性。这些失效和故障反过来又能用于改进服务，形成良性循环。

### Simian Army中有哪些Monkey

* **Chaos Monkey：**随机关闭一些VM来模拟单点失效及由其引起的不可预测的场景，测试服务的容错及动态负载均衡能力；
* **Latency Monkey：**人工产生任意长度的延迟来模拟服务降级甚至服务不可用的场景，测试服务是否能够在网络延迟(甚至依赖服务不可用)的情况下正常响应和功能；
* **Conformity Monkey：**定时扫描服务中不符合最佳实践的实例，关闭这些实例并通知owner，来助其发现问题并改正；
* **Security Monkey：**扫描服务中的安全风险及攻击实例，确保SSL和DRM证书有效；
* **Doctor Monkey：**检查每个实例的健康度(包括自身的检查和外部CPU、Memory等指标的检查)，把不健康的实例移除，由owner定位根因并解决；
* **Janitor Monkey：**扫描并移除未使用的资源，节约运营成本；
* **Howler Monkey：**监控负载是否达到一定阈值，保证服务运行在理想状态；
